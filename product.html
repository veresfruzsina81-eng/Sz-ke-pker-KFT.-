<!doctype html>
<html lang="hu">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Termék – Szőke-Épker</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js"></script>
<style>
:root{--ink:#222;--muted:#7a8594;--bg:#f5f7fb;--card:#fff;--brand:#2f6fed;--brand-2:#245bcb;--ring:0 0 0 3px rgba(47,111,237,.18);--radius:16px}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui;background:var(--bg);color:var(--ink)}
.wrap{max-width:1100px;margin:0 auto;padding:16px}
.btn{appearance:none;border:0;padding:10px 16px;border-radius:12px;cursor:pointer;font-weight:700;background:var(--brand);color:#fff}
.btn:hover{background:var(--brand-2)}
.btn.ghost{background:#fff;color:var(--brand);border:1px solid var(--brand)}
.card{background:var(--card);border:1px solid #e5e9f2;border-radius:16px;box-shadow:0 14px 32px rgba(22,29,37,.06)}
.row{display:flex;align-items:center;gap:12px}
.grid{display:grid;gap:16px}
@media(min-width:900px){.grid{grid-template-columns:520px 1fr}}
.img{width:100%;aspect-ratio:4/3;object-fit:cover;border-radius:16px;border:1px solid #e5e9f2;background:#fafbfe}
.muted{color:var(--muted)}
.price{font-weight:800;font-size:22px}
.qty{display:inline-flex;align-items:center;border:1px solid #e5e9f2;border-radius:999px;overflow:hidden}
.qty button{background:#fff;border:0;width:28px;height:28px;cursor:pointer}
.qty input{width:36px;border:0;text-align:center}
.toast{position:fixed;left:50%;bottom:20px;transform:translateX(-50%);background:#111;color:#fff;padding:10px 14px;border-radius:12px;box-shadow:0 12px 24px rgba(0,0,0,.25);opacity:0;pointer-events:none;transition:.25s}
.toast.show{opacity:1}
</style>
</head>
<body>
<div class="wrap">
  <div class="row" style="justify-content:space-between;margin-bottom:10px">
    <a class="btn ghost" href="webshop.html">← Vissza a webshopba</a>
    <a class="btn ghost" href="/">Vissza a weboldalra</a>
  </div>

  <div class="grid">
    <div><img id="p_img" class="img" alt=""></div>
    <div class="card" style="padding:16px">
      <h1 id="p_title" style="margin:0 0 6px"></h1>
      <div class="row" style="margin-bottom:10px">
        <span id="p_price" class="price"></span>
        <span id="p_stock" class="muted"></span>
      </div>
      <div class="row" style="gap:12px;margin-bottom:12px">
        <div class="qty">
          <button onclick="step(-1)">−</button>
          <input id="qty" value="1">
          <button onclick="step(+1)">+</button>
        </div>
        <button class="btn" onclick="add()">Kosárba</button>
      </div>
      <div id="p_desc" class="muted" style="white-space:pre-wrap"></div>
    </div>
  </div>
</div>

<div id="toast" class="toast">Hozzáadva a kosárhoz</div>

<script>
const SB_URL="https://gckynywmoxylwyppmkck.supabase.co";
const SB_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdja3lueXdtb3h5bHd5cHBta2NrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkzODUxODUsImV4cCI6MjA3NDk2MTE4NX0.0p2EsBFpWnYCq5IpQ6T3FsgKkJBNt0kGRd901sNBanI";
const sb=supabase.createClient(SB_URL,SB_KEY);
const HUF=n=>new Intl.NumberFormat('hu-HU').format(n||0)+" Ft";
let PRODUCT=null;
let CART=JSON.parse(localStorage.getItem("cart")||"[]");
function save(){localStorage.setItem("cart",JSON.stringify(CART))}
function toast(msg){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),1500)}
function step(d){const el=document.getElementById('qty');let v=parseInt(el.value||"1",10);v=Math.max(1,v+d);el.value=v;}
function add(){if(!PRODUCT)return;const qty=Math.max(1,parseInt(document.getElementById('qty').value||"1",10));const i=CART.findIndex(x=>String(x.id)===String(PRODUCT.id));if(i>=0)CART[i].qty+=qty;else CART.push({id:PRODUCT.id,title:PRODUCT.title,price:PRODUCT.price,image_url:PRODUCT.image_url,qty});save();toast("Hozzáadva a kosárhoz")}
async function load(){
  const id=new URL(location.href).searchParams.get("id");
  if(!id){document.body.innerHTML="<div class='wrap'><p>Hiányzó termék azonosító.</p></div>";return;}
  const {data,error}=await sb.from('products').select('id,title,price,description,image_url,instock').eq('id',id).single();
  if(error){document.body.innerHTML="<div class='wrap'><p>Hiba: "+error.message+"</p></div>";return;}
  PRODUCT=data;
  document.getElementById('p_img').src=data.image_url||'logo.png';
  document.getElementById('p_title').textContent=data.title||'-';
  document.getElementById('p_price').textContent=HUF(data.price);
  document.getElementById('p_stock').textContent=data.instock?'• készleten':'• nem elérhető';
  document.getElementById('p_desc').textContent=data.description||'Nincs leírás.';
}
load();
</script>
</body>
</html>
