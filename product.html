<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Termék – Szőke Épker</title>
  <link rel="icon" href="logo.png">
  <style>
    :root{--brand:#8b5e34;--bg:#fbf7f3}
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,Segoe UI,Roboto,sans-serif;background:var(--bg)}
    header{background:#1e293b;color:#fff;padding:.9rem 1rem}
    main{max-width:1000px;margin:24px auto;padding:0 16px}
    .wrap{display:grid;grid-template-columns:360px 1fr;gap:20px}
    .card{background:#fff;border:1px solid #eee;border-radius:14px;overflow:hidden;box-shadow:0 8px 24px rgba(0,0,0,.04)}
    .pad{padding:14px}
    img.hero{width:100%;height:320px;object-fit:cover;background:#fafafa;display:block}
    .btn{appearance:none;border:0;background:var(--brand);color:#fff;padding:.6rem 1rem;border-radius:999px;font-weight:700;cursor:pointer}
    @media(max-width:860px){ .wrap{grid-template-columns:1fr} img.hero{height:240px} }
  </style>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
<header><a href="webshop.html" style="color:#fff;text-decoration:none">&larr; Vissza a webshopra</a></header>
<main>
  <div id="view" class="card"><div class="pad">Betöltés…</div></div>
</main>

<script>
/*** TÖLTSD KI EZT A KÉT SORT ***/
const SUPABASE_URL =https://gckynywmoxylwyppmkck.supabase.co 'https://<PROJECT>.supabase.co';
const SUPABASE_ANON_KEY = '<PUBLIC-ANON-KEY>';
/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdja3lueXdtb3h5bHd5cHBta2NrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkzODUxODUsImV4cCI6MjA3NDk2MTE4NX0.0p2EsBFpWnYCq5IpQ6T3FsgKkJBNt0kGRd901sNBanI/

const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
const q = sel => document.querySelector(sel);
const fmt = n => new Intl.NumberFormat('hu-HU').format(n)+' Ft';
const id = new URL(location.href).searchParams.get('id');

async function load(){
  if(!id){ q('#view').innerHTML='<div class="pad">Hiányzó termék azonosító.</div>'; return; }
  const { data, error } = await sb.from('products')
    .select('id,title,price,instock,image_url,description')
    .eq('id', id).single();
  if(error || !data){ q('#view').innerHTML='<div class="pad">A termék nem található.</div>'; return; }

  q('#view').innerHTML = `
    <div class="wrap">
      <div><img class="hero" src="${data.image_url||'logo.png'}" alt=""></div>
      <div class="pad">
        <h1 style="margin:.2rem 0 6px">${data.title||'(névtelen)'}</h1>
        <div style="font-weight:700;margin-bottom:10px">${fmt(data.price||0)}</div>
        <div style="margin-bottom:14px">${data.instock?'Készleten':'Nem elérhető'}</div>
        <button class="btn" onclick="addToCart()">Kosárba</button>
      </div>
    </div>
    <div class="pad" style="padding-top:0">
      ${data.description ? `<h3>Leírás</h3><div>${escapeHtml(data.description).replace(/\n/g,'<br>')}</div>` : ''}
    </div>
  `;

  window.addToCart = function(){
    const cart = JSON.parse(localStorage.getItem('cart_v1')||'[]');
    const it = cart.find(x=>x.id===data.id);
    if(it) it.qty++; else cart.push({id:data.id,title:data.title,price:data.price,img:data.image_url,qty:1});
    localStorage.setItem('cart_v1', JSON.stringify(cart));
    alert('A termék a kosárba került.');
  };
}

function escapeHtml(s){ return (s||'').replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[c])); }

load();
</script>
</body>
</html>
